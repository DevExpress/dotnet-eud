<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <!-- Matomo Tag Manager -->
    <script>
      var _mtm = window._mtm = window._mtm || [];
      _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src='https://matomo.devexpress.com/js/container_kE7MWPi0.js'; s.parentNode.insertBefore(g,s);
    </script>
    <!-- End Matomo Tag Manager -->
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Insert a Calculated Field and Calculated Item | DevExpress End-User Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Insert a Calculated Field and Calculated Item | DevExpress End-User Documentation ">
      
      
      <link rel="shortcut icon" href="../../../../favicon.ico">
      <link rel="stylesheet" href="../../../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../../../styles/docfx.css">
      <link rel="stylesheet" href="../../../../styles/main.css">
      <meta property="docfx:navrel" content="../../../../toc.html">
      <meta property="docfx:tocrel" content="../../../toc.html">
      
      
      
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="insert-a-calculated-field-and-calculated-item">Insert a Calculated Field and Calculated Item</h1>

<p>If the predefined aggregation functions or the <strong>Show Values As</strong> calculation options do not meet your requirements, you can create your own formulas to calculate values in a PivotTable report by inserting <a href="#calculatedfield">calculated fields</a> and <a href="#calculateditem">calculated items</a>.</p>
<p><a name="calculatedfield"></a></p>
<h2 id="insert-a-calculated-field">Insert a Calculated Field</h2>
<p><strong>Calculated fields</strong> can perform calculations using the contents of other fields in the report. A calculated field&#39;s formula should conform to the common syntax rules and contain only supported elements.</p>
<ul>
<li>In the formula, you can use constants and refer to other fields in the pivot table. The calculation will be performed on the sum of the underlying data for any fields in the formula. When you reference a field in your formula, you can enclose its name in apostrophes or omit them.</li>
<li>You cannot create formulas that use a cell reference, defined name, circular references and arrays.</li>
<li>The formula cannot refer to the PivotTable’s subtotals, totals and Grand Total value.</li>
</ul>
<p>To insert a calculated field, do the following.</p>
<ol>
<li><p>Select a cell within the PivotTable report and on <strong>PivotTable Tools</strong> | <strong>Analyze</strong> tab, in the <strong>Calculation</strong> group, click the <strong>Fields, Items, &amp; Sets</strong> button. In the drop-down menu, select the <strong>Calculated Field...</strong> item to invoke the <strong>Insert Calculated Field</strong> dialog. </p>
<p> <img src="../../../images/img126512.png" alt="Spreadsheet_PivotTable_CalculatedField_Ribbon"></p>
</li>
<li><p>In the dialog window, specify the name and formula for the calculated field. To use data from another field in the formula, click the required field in the <strong>Fields</strong> box, and then click <strong>Insert Field</strong>. </p>
<p> <img src="../../../images/img126513.png" alt="Spreadsheet_PivotTable_CalculatedField_InsertDialog"></p>
</li>
<li><p>Click <strong>Add</strong>, and then click <strong>OK</strong>. As a result, the new field will be automatically added to the <strong>Values</strong> area of the PivotTable report. </p>
<p> <img src="../../../images/img126514.png" alt="Spreadhseet_PivotTable_CalculatedField_Result"></p>
</li>
<li><p>To delete a calculated field, invoke the <strong>Insert Calculated Field</strong> dialog, select the required field from the <strong>Name</strong> drop-down list and click <strong>Delete</strong>. </p>
<p> <img src="../../../images/img126628.png" alt="Spreadsheet_PivotTable_CalculatedField_Delete"></p>
</li>
</ol>
<p><a name="calculateditem"></a></p>
<h2 id="insert-a-calculated-item">Insert a Calculated Item</h2>
<p>A <strong>calculated item</strong> is a custom item in a PivotTable field whose value is produced based on values of other items in the same field. Before inserting a calculated item, take into account the following restrictions.</p>
<ul>
<li>You cannot add a calculated item to a page field. Also, you cannot move a row or column field containing calculated items to the page area of the PivotTable report.</li>
<li>You cannot add a calculated item to a grouped field. Ungroup the field before inserting the calculated item.</li>
<li>You cannot add multiple copies of a field containing calculated items to the data area.</li>
<li>You cannot add a calculated item to a PivotTable report that uses the <strong>Average</strong>, <strong>StdDev</strong>, <strong>StdDevp</strong>, <strong>Var</strong> or <strong>Varp</strong> aggregation function in the data area.</li>
</ul>
<p>To insert a calculated item, follow the steps below.</p>
<ol>
<li><p>Select a cell in the field to which the calculated item should be added. On the <strong>PivotTable Tools</strong> | <strong>Analyze</strong> tab, in the <strong>Calculations</strong> group, click the <strong>Fields, Items, &amp; Sets</strong> item and select the <strong>Calculated Item...</strong> item from the drop-down menu.</p>
<p> <img src="../../../images/img126515.png" alt="Spreadsheet_PivotTable_CalculatedItem_Ribbon"></p>
</li>
<li><p>In the invoked <strong>Insert Calculated Item</strong> dialog, specify the name and formula for the calculated item. To use a value of another item in the formula, click the required item in the <strong>Items</strong> list, and then click <strong>Insert Item</strong>. Note that you can use only items from the same field as the calculated item.</p>
<p> <img src="../../../images/img126516.png" alt="Spreadsheet_PivotTable_CalculatedItem_Dialog"></p>
</li>
<li><p>Click <strong>Add</strong>, and then click <strong>OK</strong>. As a result, the new item will be added to the field. </p>
<p> <img src="../../../images/img126517.png" alt="Spreadsheet_PivotTable_CalculatedItem_Result"></p>
</li>
<li><p>To delete a calculated item, invoke the <strong>Insert Calculated Item</strong> dialog, select the required item from the <strong>Name</strong> drop-down list and click <strong>Delete</strong>. </p>
<p> <img src="../../../images/img126629.png" alt="Spreadsheet_PivotTable_CalculatedItem_Delete"></p>
</li>
</ol>
<h2 id="create-a-list-of-the-pivottable-formulas">Create a List of the PivotTable Formulas</h2>
<p>You can automatically create a list of all the calculated fields and items used in the current pivot table. To do that, on the <strong>PivotTable Tools</strong> | <strong>Analyze</strong> tab, in the <strong>Calculations</strong> group, click the <strong>Fields, Items, &amp; Sets</strong> item and select the <strong>List Formulas</strong> item from the drop-down menu. As a result, the list will be created on a new worksheet and will appear as in the image below. </p>
<p><img src="../../../images/img126690.png" alt="Spreadsheet_PivotTable_CalculatedItems_ListFormulas"></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/DevExpress/dotnet-eud/blob/23.2/interface-elements-for-desktop/articles/spreadsheet/pivot-tables/insert-a-calculated-field-and-calculated-item.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright (c) 1998-2024 Developer Express Inc. All rights reserved.
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
