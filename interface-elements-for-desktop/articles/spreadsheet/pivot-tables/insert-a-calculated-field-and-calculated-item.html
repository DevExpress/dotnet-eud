<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Insert a Calculated Field and Calculated Item | DevExpress End-User Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Insert a Calculated Field and Calculated Item | DevExpress End-User Documentation ">
      
      
      <link rel="icon" href="../../../../favicon.ico">
      <link rel="stylesheet" href="../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/DevExpress/dotnet-eud/blob/25.1/interface-elements-for-desktop/articles/spreadsheet/pivot-tables/insert-a-calculated-field-and-calculated-item.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

      <!-- Matomo Tag Manager -->
      <script>
        var _mtm = window._mtm = window._mtm || [];
        _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src='https://matomo.devexpress.com/js/container_kE7MWPi0.js'; s.parentNode.insertBefore(g,s);
      </script>
      <!-- End Matomo Tag Manager -->
  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../index.html">
            <img id="logo" class="svg" src="../../../../logo.svg" alt="DevExpress EUD">
            DevExpress EUD
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="insert-a-calculated-field-and-calculated-item">Insert a Calculated Field and Calculated Item</h1>

<p>If the predefined aggregation functions or the <strong>Show Values As</strong> calculation options do not meet your requirements, you can create your own formulas to calculate values in a PivotTable report by inserting <a href="#calculatedfield">calculated fields</a> and <a href="#calculateditem">calculated items</a>.</p>
<a name="calculatedfield"></a>
<h2 id="insert-a-calculated-field">Insert a Calculated Field</h2>
<p><strong>Calculated fields</strong> can perform calculations using the contents of other fields in the report. A calculated field's formula should conform to the common syntax rules and contain only supported elements.</p>
<ul>
<li>In the formula, you can use constants and refer to other fields in the pivot table. The calculation will be performed on the sum of the underlying data for any fields in the formula. When you reference a field in your formula, you can enclose its name in apostrophes or omit them.</li>
<li>You cannot create formulas that use a cell reference, defined name, circular references and arrays.</li>
<li>The formula cannot refer to the PivotTable’s subtotals, totals and Grand Total value.</li>
</ul>
<p>To insert a calculated field, do the following.</p>
<ol>
<li><p>Select a cell within the PivotTable report and on <strong>PivotTable Tools</strong> | <strong>Analyze</strong> tab, in the <strong>Calculation</strong> group, click the <strong>Fields, Items, &amp; Sets</strong> button. In the drop-down menu, select the <strong>Calculated Field...</strong> item to invoke the <strong>Insert Calculated Field</strong> dialog.</p>
<p><img src="../../../images/img126512.png" alt="Spreadsheet_PivotTable_CalculatedField_Ribbon"></p>
</li>
<li><p>In the dialog window, specify the name and formula for the calculated field. To use data from another field in the formula, click the required field in the <strong>Fields</strong> box, and then click <strong>Insert Field</strong>.</p>
<p><img src="../../../images/img126513.png" alt="Spreadsheet_PivotTable_CalculatedField_InsertDialog"></p>
</li>
<li><p>Click <strong>Add</strong>, and then click <strong>OK</strong>. As a result, the new field will be automatically added to the <strong>Values</strong> area of the PivotTable report.</p>
<p><img src="../../../images/img126514.png" alt="Spreadhseet_PivotTable_CalculatedField_Result"></p>
</li>
<li><p>To delete a calculated field, invoke the <strong>Insert Calculated Field</strong> dialog, select the required field from the <strong>Name</strong> drop-down list and click <strong>Delete</strong>.</p>
<p><img src="../../../images/img126628.png" alt="Spreadsheet_PivotTable_CalculatedField_Delete"></p>
</li>
</ol>
<a name="calculateditem"></a>
<h2 id="insert-a-calculated-item">Insert a Calculated Item</h2>
<p>A <strong>calculated item</strong> is a custom item in a PivotTable field whose value is produced based on values of other items in the same field. Before inserting a calculated item, take into account the following restrictions.</p>
<ul>
<li>You cannot add a calculated item to a page field. Also, you cannot move a row or column field containing calculated items to the page area of the PivotTable report.</li>
<li>You cannot add a calculated item to a grouped field. Ungroup the field before inserting the calculated item.</li>
<li>You cannot add multiple copies of a field containing calculated items to the data area.</li>
<li>You cannot add a calculated item to a PivotTable report that uses the <strong>Average</strong>, <strong>StdDev</strong>, <strong>StdDevp</strong>, <strong>Var</strong> or <strong>Varp</strong> aggregation function in the data area.</li>
</ul>
<p>To insert a calculated item, follow the steps below.</p>
<ol>
<li><p>Select a cell in the field to which the calculated item should be added. On the <strong>PivotTable Tools</strong> | <strong>Analyze</strong> tab, in the <strong>Calculations</strong> group, click the <strong>Fields, Items, &amp; Sets</strong> item and select the <strong>Calculated Item...</strong> item from the drop-down menu.</p>
<p><img src="../../../images/img126515.png" alt="Spreadsheet_PivotTable_CalculatedItem_Ribbon"></p>
</li>
<li><p>In the invoked <strong>Insert Calculated Item</strong> dialog, specify the name and formula for the calculated item. To use a value of another item in the formula, click the required item in the <strong>Items</strong> list, and then click <strong>Insert Item</strong>. Note that you can use only items from the same field as the calculated item.</p>
<p><img src="../../../images/img126516.png" alt="Spreadsheet_PivotTable_CalculatedItem_Dialog"></p>
</li>
<li><p>Click <strong>Add</strong>, and then click <strong>OK</strong>. As a result, the new item will be added to the field.</p>
<p><img src="../../../images/img126517.png" alt="Spreadsheet_PivotTable_CalculatedItem_Result"></p>
</li>
<li><p>To delete a calculated item, invoke the <strong>Insert Calculated Item</strong> dialog, select the required item from the <strong>Name</strong> drop-down list and click <strong>Delete</strong>.</p>
<p><img src="../../../images/img126629.png" alt="Spreadsheet_PivotTable_CalculatedItem_Delete"></p>
</li>
</ol>
<h2 id="create-a-list-of-the-pivottable-formulas">Create a List of the PivotTable Formulas</h2>
<p>You can automatically create a list of all the calculated fields and items used in the current pivot table. To do that, on the <strong>PivotTable Tools</strong> | <strong>Analyze</strong> tab, in the <strong>Calculations</strong> group, click the <strong>Fields, Items, &amp; Sets</strong> item and select the <strong>List Formulas</strong> item from the drop-down menu. As a result, the list will be created on a new worksheet and will appear as in the image below.</p>
<p><img src="../../../images/img126690.png" alt="Spreadsheet_PivotTable_CalculatedItems_ListFormulas"></p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/DevExpress/dotnet-eud/blob/25.1/interface-elements-for-desktop/articles/spreadsheet/pivot-tables/insert-a-calculated-field-and-calculated-item.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Copyright (c) 1998-2025 Developer Express Inc. All rights reserved.
        </div>
      </div>
    </footer>
  </body>
</html>
