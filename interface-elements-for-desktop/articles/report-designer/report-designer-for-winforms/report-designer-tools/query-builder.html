<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Query Builder | DevExpress End-User Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Query Builder | DevExpress End-User Documentation ">
    <meta name="generator" content="docfx 2.56.7.0">
    
    <link rel="shortcut icon" href="../../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../../index.html">
                <img id="logo" class="svg" src="../../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="query-builder">Query Builder</h1>

<p>The <strong>Query Builder</strong> provides a visual interface for constructing SQL queries used to access database tables and views.</p>
<p><img src="../../../../images/eurd-win-query-builder.png" alt="query-builder"></p>
<div class="NOTE"><h5>Note</h5><p>The Query Builder is not available for <a href="data-source-wizard/connect-to-an-object-data-source.html">object</a>, <a href="data-source-wizard/connect-to-an-entity-framework-data-source.html">Entity Framework</a> and <a href="data-source-wizard/connect-to-an-excel-data-source.html">Excel</a> data sources.</p>
</div>
<h2 id="runquerybuilder">Run the Query Builder</h2>
<p>You can invoke the <strong>Query Builder</strong> from the <a href="data-source-wizard/connect-to-a-database/create-a-query-or-select-a-stored-procedure.html">query customization</a> page of the <a href="report-wizard.html">Report Wizard</a>. On this page, click the <img src="../../../../images/eurd-win-report-wizard-multi-query-page-icon-add.png" alt="report-wizard-multi-query-page-icon-add"> button for the <strong>Queries</strong> category to create a new query using the Query Builder.</p>
<p><img src="../../../../images/eurd-win-report-wizard-invoke-query-builder.png" alt="eurd-win-report-wizard-invoke-query-builder"></p>
<p>You can use the Query Builder to add queries to an existing SQL data source, as well as to edit existing queries. To do this, right-click the data source in the <a href="ui-panels/report-explorer.html">Report Explorer</a> or <a href="ui-panels/field-list.html">Field List</a>, and select <strong>Manage Queries...</strong> in the context menu.</p>
<p><img src="../../../../images/eurd-win-report-explorer-field-list-manage-queries.png" alt="report-explorer-field-list-manage-queries"></p>
<p>In the invoked <strong>Manage Queries</strong> dialog, click <strong>Add</strong> to add a new query. To edit an existing query, click the ellipsis button for it.</p>
<p><img src="../../../../images/eurd-win-query-designer-query-collection-editor.png" alt="query-designer-query-collection-editor"></p>
<p>Finally, click the <strong>Run Query Builder...</strong> button in the invoked <strong>Query Editor</strong>.</p>
<h2 id="selecttables">Select Tables</h2>
<p>You can add a specific data table or view to a query by dragging the corresponding item from the list of available tables and dropping it onto the list of data tables to be used.</p>
<p><img src="../../../../images/qeurd-win-uery-builder-diagram-drop-table.png" alt="query-builder-diagram-drop-table"></p>
<p>Enable check boxes for the table fields that you want to include in the query result set.</p>
<p><img src="../../../../images/eurd-win-query-builder-diagram-select-fields.png" alt="query-builder-diagram-select-fields"></p>
<p>Each table provides the context menu, which allows you to rename the table or remove it from the query.</p>
<p><img src="../../../../images/eurd-win-query-builder-diagram-table-context-menu.png" alt="query-builder-diagram-table-context-menu"></p>
<p>Click the list of available tables on the left and press CTRL+F to search for a specific table or view.</p>
<p><img src="../../../../images/eurd-win-query-builder-search-table.png" alt="query-builder-search-table"></p>
<h2 id="jointables">Join Tables</h2>
<p>You can join multiple tables within the same query. The Query Builder automatically highlights tables related to any of the previously added tables. Drag-and-drop a subordinate table in the same way you added a main table to include it in a query and automatically create an inner join relation based on a key column.</p>
<p><img src="../../../../images/eurd-win-query-builder-diagram-join-tables.png" alt="query-builder-diagram-join-tables"></p>
<p>Alternatively, you can join tables by clicking the plus button <img src="../../../../images/eurd-win-query-builder-plus-button.png" alt="QueryBuilderPlusButton"> in a row corresponding to a key column.</p>
<p>You can customize the relationship by right-clicking it on the diagram and selecting <strong>Edit Relation</strong> in the invoked context menu. Use the <strong>Join Editor</strong> to select the join type (<strong>Left Outer</strong> or <strong>Inner</strong>), apply a logical operator (<strong>Equals to</strong>, <strong>Is less than</strong>, etc.) and column key fields.</p>
<p><img src="../../../../images/eurd-win-query-builder-diagram-join-editor.png" alt="query-builder-diagram-join-editor"></p>
<p>A left outer join returns an inner join’s values, along with all the values in the &quot;left&quot; table that do not match the &quot;right&quot; table, including rows with NULL (empty) values in the key field.</p>
<p>When the left outer join is selected, the relationship line displays an arrow pointing to the &quot;right&quot; table.</p>
<p><img src="../../../../images/eurd-win-query-builder-diagram-left-outer-join.png" alt="query-builder-diagram-left-outer-join"></p>
<p>You can manually join tables if they do not have a relationship at the database level. In this case, when you drag-and-drop a table onto the list of tables, the <strong>Join Editor</strong> is automatically invoked allowing you to construct a custom <strong>join</strong> relationship.</p>
<p>After executing the query, it returns a &quot;flat&quot; table composed of data records selected based on the specified join options.</p>
<div class="NOTE"><h5>Note</h5><p>Although joining different tables within a single query may be required in some scenarios, creating <a href="data-source-wizard/connect-to-a-database/create-a-query-or-select-a-stored-procedure.html">hierarchical data sources</a> generally results in better performance (in general, <a href="../create-reports/master-detail-reports-with-detail-report-bands.html">master-detail reports</a> are generated faster than similar-looking reports created by grouping &quot;flat&quot; data sources).</p>
</div>
<h2 id="editparameters">Edit Parameters</h2>
<p>Click the <strong>Edit Parameters</strong> button to invoke the <strong>Query Parameters</strong> dialog, which allows you to add and remove <a href="../bind-to-data/specify-query-parameters.html">query parameters</a> as well as specify parameter settings.</p>
<p><img src="../../../../images/eurd-win-query-builder-diagram-query-parameters.png" alt="query-builder-diagram-query-parameters"></p>
<p>For each query parameter, the following properties are available.</p>
<ul>
<li><strong>Name</strong> - specifies the name used to refer a parameter.</li>
<li><strong>Type</strong> - specifies the data type of the parameter&#39;s value.</li>
<li><strong>Expression</strong> - determines whether the actual parameter value is static or generated dynamically.</li>
<li><strong>Value</strong> - specifies the actual value of a query parameter. If the <strong>Expression</strong> option is enabled, the actual parameter value is produced dynamically by calculating an associated <a href="../use-expressions.html">expression</a>, which is particularly useful when you need to map the query parameter value to the value of a <a href="../shape-report-data/use-report-parameters.html">report parameter</a>.</li>
</ul>
<p>The created parameters will be then available on the <a href="data-source-wizard/connect-to-a-database/configure-query-parameters.html">Configure Query Parameters</a> wizard page.</p>
<p>For general information on query parameters and ways of providing parameter values, see <a href="../bind-to-data/specify-query-parameters.html">Specify Query Parameters</a>.</p>
<h2 id="filterdata">Filter Data</h2>
<p>To specify filter criteria, click the <strong>Filter...</strong> button in the Query Builder. This invokes the <strong>Filter Editor</strong>, which provides the following capabilities.</p>
<p><img src="../../../../images/eurd-win-query-designer-filter.png" alt="query-designer-filter"></p>
<ul>
<li><p><strong>Filter Tab</strong></p>
<p>  The editor contains the <strong>Filter</strong> tab allowing you to specify filter conditions for resulting data. Filter criteria can be assigned <a href="data-source-wizard/connect-to-a-database/configure-query-parameters.html">query parameters</a> or bound to <a href="../shape-report-data/use-report-parameters.html">report parameters</a>.</p>
</li>
<li><p><strong>Group Filter Tab</strong></p>
<p>  The <strong>Group Filter</strong> tab allows you to specify filter conditions for grouped and aggregated data. If data is not grouped, the second tab is disabled.</p>
</li>
<li><p><strong>Other Options</strong></p>
<p>  Using this editor, you can limit the number of resulting data rows. If data is sorted, you can specify how many rows to skip before retrieving the specified number of rows.</p>
<div class="NOTE"><h5>Note</h5><p>Depending on the selected data provider, it can be impossible to take into account the skip setting in the provider-specific SQL string.</p>
</div>
<p>  Another option enables you to include only distinct values into the resulting set.</p>
</li>
</ul>
<h2 id="shapedata">Shape Data</h2>
<p>The Query Builder displays the column list under the data source editor, which provides various shaping options:</p>
<p><img src="../../../../images/eurd-win-query-builder-column-list-shaping-data.png" alt="query-builder-column-list-shaping-data"></p>
<ul>
<li><p><strong>Column</strong></p>
<p>  Specifies the selected column.</p>
<p>  You can choose a column from the drop-down list or create a column expression by clicking the corresponding column&#39;s ellipsis button.</p>
<p>  <img src="../../../../images/eurd-win-query-builder-column-expression.png" alt="query-builder-column-expression"></p>
</li>
<li><p><strong>Table</strong></p>
<p>  Specifies the table containing the selected column.</p>
<p>  This option indicates <strong>(All Tables)</strong> if you created an expression for the corresponding column.</p>
</li>
<li><p><strong>Alias</strong></p>
<p>  Specifies a custom column name (alias).</p>
<p>  This option is available only for columns that you included in a query.</p>
</li>
<li><p><strong>Output</strong></p>
<p>  Specifies whether to include the column in the query&#39;s resulting set.</p>
</li>
<li><p><strong>Sorting Type</strong></p>
<p>  Specifies whether to preserve the original data record order within the column or sort them (ascending or descending).</p>
<div class="NOTE"><h5>Note</h5><p>When binding to XML files, the Query Builder does not support sorting by aggregate functions, DISTINCT and SELECT ALL statements, and custom SQL.</p>
</div>
</li>
<li><p><strong>Sort Order</strong></p>
<p>  This option becomes available after applying sorting to the data column records.</p>
<p>  It defines the priority in which sorting is applied to multiple columns (a lower number has a higher priority).</p>
<p>  For example, if column <strong>A</strong> has the sort order set to <strong>1</strong> and column <strong>B</strong> has it set to <strong>2</strong>, the query is first sorted by column <strong>A</strong> and then by the column <strong>B</strong>.</p>
<p>  Changing this setting for one column automatically updates other columns’ sorting order to avoid conflicting priorities.</p>
</li>
<li><p><strong>Group By</strong></p>
<p>  Specifies whether to group the query&#39;s resulting set by this column.</p>
</li>
<li><p><strong>Aggregate</strong></p>
<p>  Specifies whether to aggregate the column&#39;s data records.</p>
<p>  The following aggregate functions are supported:</p>
<ul>
<li>Count</li>
<li>Max</li>
<li>Min</li>
<li>Avg</li>
<li>Sum</li>
<li>CountDistinct</li>
<li>AvgDistinct</li>
<li><p>SumDistinct</p>
<p>Applying any of these functions to a column discards individual data records from the query result set, which only includes the aggregate function result.</p>
</li>
</ul>
</li>
</ul>
<div class="NOTE"><h5>Note</h5><p>You should apply aggregation/grouping to either all columns or none of them.</p>
</div>
<h2 id="previewresults">Preview Results</h2>
<p>You can preview the query execution&#39;s result in a tabular form by clicking the <strong>Preview Results</strong> button.</p>
<p>This opens the <strong>Data Preview</strong> window displaying the query result set (limited to the first 1000 data records).</p>
<p><img src="../../../../images/eurd-win-query-designer-preview.png" alt="query-designer-preview"></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/DevExpress/dotnet-eud/blob/21.1/interface-elements-for-desktop/articles/report-designer/report-designer-for-winforms/report-designer-tools/query-builder.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright (c) 1998-2019 Developer Express Inc. All rights reserved.
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../../styles/main.js"></script>
  </body>
</html>
